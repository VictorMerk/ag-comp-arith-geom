<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Translation Management - AG Computational Arithmetic Geometry</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/assets/css/flag-icons.css">
    <style>
        .translation-key {
            font-family: monospace;
            background: #f8f9fa;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.9em;
        }
        .translation-section {
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }
        .translation-row {
            margin-bottom: 15px;
            padding: 10px;
            border: 1px solid #e9ecef;
            border-radius: 5px;
            background: #f8f9fa;
        }
        .language-tabs {
            margin-bottom: 20px;
        }
        .save-status {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }
    </style>
</head>
<body>
    <div class="container-fluid mt-4">
        <div class="row">
            <div class="col-12">
                <h1 class="mb-4">Translation Management</h1>
                <p class="lead">Manage translations for the bilingual website. All changes are saved automatically.</p>
                
                <div class="save-status" id="save-status" style="display: none;">
                    <div class="alert alert-success" role="alert">
                        <i class="fas fa-check"></i> Translations saved successfully!
                    </div>
                </div>

                <div class="language-tabs">
                    <ul class="nav nav-tabs" id="languageTabs" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="en-tab" data-bs-toggle="tab" data-bs-target="#en-content" type="button" role="tab">
                                <span class="flag-icon flag-icon-us me-2"></span>English
                            </button>
                        </li>
                        <li class="nav-item" role="presentation">
                            <button class="nav-link" id="de-tab" data-bs-toggle="tab" data-bs-target="#de-content" type="button" role="tab">
                                <span class="flag-icon flag-icon-de me-2"></span>Deutsch
                            </button>
                        </li>
                    </ul>
                </div>

                <div class="tab-content" id="languageTabContent">
                    <!-- English Translations -->
                    <div class="tab-pane fade show active" id="en-content" role="tabpanel">
                        <div id="en-translations">
                            <!-- Navigation -->
                            <div class="translation-section">
                                <h3>Navigation</h3>
                                <div class="translation-row">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <strong>Key:</strong> <span class="translation-key">nav.about</span>
                                        </div>
                                        <div class="col-md-9">
                                            <input type="text" class="form-control" data-key="nav.about" data-lang="en" value="About">
                                        </div>
                                    </div>
                                </div>
                                <div class="translation-row">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <strong>Key:</strong> <span class="translation-key">nav.research</span>
                                        </div>
                                        <div class="col-md-9">
                                            <input type="text" class="form-control" data-key="nav.research" data-lang="en" value="Research">
                                        </div>
                                    </div>
                                </div>
                                <div class="translation-row">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <strong>Key:</strong> <span class="translation-key">nav.publications</span>
                                        </div>
                                        <div class="col-md-9">
                                            <input type="text" class="form-control" data-key="nav.publications" data-lang="en" value="Publications">
                                        </div>
                                    </div>
                                </div>
                                <div class="translation-row">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <strong>Key:</strong> <span class="translation-key">nav.teaching</span>
                                        </div>
                                        <div class="col-md-9">
                                            <input type="text" class="form-control" data-key="nav.teaching" data-lang="en" value="Teaching">
                                        </div>
                                    </div>
                                </div>
                                <div class="translation-row">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <strong>Key:</strong> <span class="translation-key">nav.members</span>
                                        </div>
                                        <div class="col-md-9">
                                            <input type="text" class="form-control" data-key="nav.members" data-lang="en" value="Members">
                                        </div>
                                    </div>
                                </div>
                                <div class="translation-row">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <strong>Key:</strong> <span class="translation-key">nav.contact</span>
                                        </div>
                                        <div class="col-md-9">
                                            <input type="text" class="form-control" data-key="nav.contact" data-lang="en" value="Contact">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- About Page -->
                            <div class="translation-section">
                                <h3>About Page</h3>
                                <div class="translation-row">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <strong>Key:</strong> <span class="translation-key">about.description</span>
                                        </div>
                                        <div class="col-md-9">
                                            <textarea class="form-control" data-key="about.description" data-lang="en" rows="3">This is the website of the research group "computational arithmetic geometry" at the Interdisciplinary Center for Scientific Computing (IWR) in Heidelberg.</textarea>
                                        </div>
                                    </div>
                                </div>
                                <div class="translation-row">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <strong>Key:</strong> <span class="translation-key">about.content</span>
                                        </div>
                                        <div class="col-md-9">
                                            <textarea class="form-control" data-key="about.content" data-lang="en" rows="4">Within algebraic number theory and arithmetic geometry, the focus of the research group is on Galois representations, their relations to modular forms and elliptic curves, their deformation theory etc., as well as on some aspects of function field arithmetic such as L-functions and Drinfeld modular forms.</textarea>
                                        </div>
                                    </div>
                                </div>
                                <div class="translation-row">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <strong>Key:</strong> <span class="translation-key">about.methods</span>
                                        </div>
                                        <div class="col-md-9">
                                            <textarea class="form-control" data-key="about.methods" data-lang="en" rows="4">To tackle problems in the themes described above, we apply a broad range of methods. On one hand we pursue these questions by purely theoretical methods. On the other, we use computer algebra to carry out experiments that help us gather examples for the theory or to solve particular questions that arise from the theory. Some members of our group have also developed routines on top of existing computer algebra packages.</textarea>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Research Page -->
                            <div class="translation-section">
                                <h3>Research Page</h3>
                                <div class="translation-row">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <strong>Key:</strong> <span class="translation-key">research.intro_lead</span>
                                        </div>
                                        <div class="col-md-9">
                                            <textarea class="form-control" data-key="research.intro_lead" data-lang="en" rows="3">Our research focuses on <strong>arithmetic geometry</strong> and <strong>number theory</strong>, with particular emphasis on computational methods and their applications.</textarea>
                                        </div>
                                    </div>
                                </div>
                                <div class="translation-row">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <strong>Key:</strong> <span class="translation-key">research.areas_title</span>
                                        </div>
                                        <div class="col-md-9">
                                            <input type="text" class="form-control" data-key="research.areas_title" data-lang="en" value="Research Areas">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- German Translations -->
                    <div class="tab-pane fade" id="de-content" role="tabpanel">
                        <div id="de-translations">
                            <!-- Navigation -->
                            <div class="translation-section">
                                <h3>Navigation</h3>
                                <div class="translation-row">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <strong>Key:</strong> <span class="translation-key">nav.about</span>
                                        </div>
                                        <div class="col-md-9">
                                            <input type="text" class="form-control" data-key="nav.about" data-lang="de" value="Über uns">
                                        </div>
                                    </div>
                                </div>
                                <div class="translation-row">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <strong>Key:</strong> <span class="translation-key">nav.research</span>
                                        </div>
                                        <div class="col-md-9">
                                            <input type="text" class="form-control" data-key="nav.research" data-lang="de" value="Forschung">
                                        </div>
                                    </div>
                                </div>
                                <div class="translation-row">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <strong>Key:</strong> <span class="translation-key">nav.publications</span>
                                        </div>
                                        <div class="col-md-9">
                                            <input type="text" class="form-control" data-key="nav.publications" data-lang="de" value="Publikationen">
                                        </div>
                                    </div>
                                </div>
                                <div class="translation-row">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <strong>Key:</strong> <span class="translation-key">nav.teaching</span>
                                        </div>
                                        <div class="col-md-9">
                                            <input type="text" class="form-control" data-key="nav.teaching" data-lang="de" value="Lehre">
                                        </div>
                                    </div>
                                </div>
                                <div class="translation-row">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <strong>Key:</strong> <span class="translation-key">nav.members</span>
                                        </div>
                                        <div class="col-md-9">
                                            <input type="text" class="form-control" data-key="nav.members" data-lang="de" value="Mitglieder">
                                        </div>
                                    </div>
                                </div>
                                <div class="translation-row">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <strong>Key:</strong> <span class="translation-key">nav.contact</span>
                                        </div>
                                        <div class="col-md-9">
                                            <input type="text" class="form-control" data-key="nav.contact" data-lang="de" value="Kontakt">
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- About Page -->
                            <div class="translation-section">
                                <h3>About Page</h3>
                                <div class="translation-row">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <strong>Key:</strong> <span class="translation-key">about.description</span>
                                        </div>
                                        <div class="col-md-9">
                                            <textarea class="form-control" data-key="about.description" data-lang="de" rows="3">Dies ist die Website der Forschungsgruppe "Computational Arithmetic Geometry" am Interdisziplinären Zentrum für Wissenschaftliches Rechnen (IWR) in Heidelberg.</textarea>
                                        </div>
                                    </div>
                                </div>
                                <div class="translation-row">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <strong>Key:</strong> <span class="translation-key">about.content</span>
                                        </div>
                                        <div class="col-md-9">
                                            <textarea class="form-control" data-key="about.content" data-lang="de" rows="4">Innerhalb der algebraischen Zahlentheorie und arithmetischen Geometrie liegt der Schwerpunkt der Forschungsgruppe auf Galois-Darstellungen, ihren Beziehungen zu Modulformen und elliptischen Kurven, ihrer Deformationstheorie usw. sowie auf einigen Aspekten der Funktionenkörper-Arithmetik wie L-Funktionen und Drinfeld-Modulformen.</textarea>
                                        </div>
                                    </div>
                                </div>
                                <div class="translation-row">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <strong>Key:</strong> <span class="translation-key">about.methods</span>
                                        </div>
                                        <div class="col-md-9">
                                            <textarea class="form-control" data-key="about.methods" data-lang="de" rows="4">Um Probleme in den oben beschriebenen Themen zu lösen, wenden wir eine breite Palette von Methoden an. Einerseits verfolgen wir diese Fragen mit rein theoretischen Methoden. Andererseits verwenden wir Computeralgebra, um Experimente durchzuführen, die uns helfen, Beispiele für die Theorie zu sammeln oder bestimmte Fragen zu lösen, die sich aus der Theorie ergeben. Einige Mitglieder unserer Gruppe haben auch Routinen auf Basis bestehender Computeralgebra-Pakete entwickelt.</textarea>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Research Page -->
                            <div class="translation-section">
                                <h3>Research Page</h3>
                                <div class="translation-row">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <strong>Key:</strong> <span class="translation-key">research.intro_lead</span>
                                        </div>
                                        <div class="col-md-9">
                                            <textarea class="form-control" data-key="research.intro_lead" data-lang="de" rows="3">Unsere Forschung konzentriert sich auf <strong>arithmetische Geometrie</strong> und <strong>Zahlentheorie</strong>, mit besonderem Schwerpunkt auf computergestützten Methoden und deren Anwendungen.</textarea>
                                        </div>
                                    </div>
                                </div>
                                <div class="translation-row">
                                    <div class="row">
                                        <div class="col-md-3">
                                            <strong>Key:</strong> <span class="translation-key">research.areas_title</span>
                                        </div>
                                        <div class="col-md-9">
                                            <input type="text" class="form-control" data-key="research.areas_title" data-lang="de" value="Forschungsbereiche">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Translation Management System
        class TranslationManager {
            constructor() {
                this.translations = {};
                this.loadTranslations();
                this.setupEventListeners();
            }

            async loadTranslations() {
                try {
                    const response = await fetch('/assets/js/translations.json');
                    this.translations = await response.json();
                    this.populateForm();
                } catch (error) {
                    console.error('Failed to load translations:', error);
                }
            }

            populateForm() {
                // Populate form fields with current translations
                document.querySelectorAll('[data-key][data-lang]').forEach(input => {
                    const key = input.getAttribute('data-key');
                    const lang = input.getAttribute('data-lang');
                    const value = this.getNestedValue(this.translations[lang], key);
                    if (value) {
                        input.value = value;
                    }
                });
            }

            getNestedValue(obj, path) {
                const keys = path.split('.');
                let current = obj;
                
                for (const key of keys) {
                    if (current && current[key] !== undefined) {
                        current = current[key];
                    } else {
                        return null;
                    }
                }
                
                return current;
            }

            setNestedValue(obj, path, value) {
                const keys = path.split('.');
                let current = obj;
                
                for (let i = 0; i < keys.length - 1; i++) {
                    if (!current[keys[i]]) {
                        current[keys[i]] = {};
                    }
                    current = current[keys[i]];
                }
                
                current[keys[keys.length - 1]] = value;
            }

            setupEventListeners() {
                // Auto-save on input change
                document.querySelectorAll('[data-key][data-lang]').forEach(input => {
                    input.addEventListener('input', () => {
                        this.saveTranslation(input);
                    });
                });
            }

            saveTranslation(input) {
                const key = input.getAttribute('data-key');
                const lang = input.getAttribute('data-lang');
                const value = input.value;

                if (!this.translations[lang]) {
                    this.translations[lang] = {};
                }

                this.setNestedValue(this.translations[lang], key, value);
                this.saveToStorage();
                this.showSaveStatus();
            }

            saveToStorage() {
                localStorage.setItem('admin-translations', JSON.stringify(this.translations));
            }

            showSaveStatus() {
                const status = document.getElementById('save-status');
                status.style.display = 'block';
                
                setTimeout(() => {
                    status.style.display = 'none';
                }, 2000);
            }

            exportTranslations() {
                const dataStr = JSON.stringify(this.translations, null, 2);
                const dataBlob = new Blob([dataStr], {type: 'application/json'});
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = 'translations.json';
                link.click();
                URL.revokeObjectURL(url);
            }
        }

        // Initialize translation manager
        document.addEventListener('DOMContentLoaded', () => {
            window.translationManager = new TranslationManager();
        });
    </script>
</body>
</html> 